<template>
    ---json
    {
        "features": {
            "toolbar": {
                "enabled": false
            }
        },
        "templating": {
            "extends": "templates/layouts/base.html"
        },
        "script": {
            "custom": [
                "resources/scripts/facets.js",
                "resources/scripts/browse.js"
            ]
        }
    }
    ---
    [% template hero %]
        [% if $context?features?hero %]
            <div class="hero">
                <h1>[[ $label ]]</h1>
            </div>
        [% endif %]
    [% endtemplate %]
    <nav class="top-left">
        <ul></ul>
        <ul>
            <li>
                <a class="aside-toggle" title="Hide" data-toggle=".left">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-arrow-bar-left" viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                            d="M12.5 15a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 1 0v13a.5.5 0 0 1-.5.5M10 8a.5.5 0 0 1-.5.5H3.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L3.707 7.5H9.5a.5.5 0 0 1 .5.5" />
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
    <aside class="left">
        <pb-search id="search-form" subscribe="search" value="[[ $request?parameters?query ]]"
            subforms=".facets,.options" submit-on-load="submit-on-load">
            <button slot="searchButton"><pb-i18n key="search.search">Search</pb-i18n></button>
            <input type="hidden" name="field" value="text"/>
        </pb-search>
        <pb-custom-form class="options">
            <input type="hidden" name="collection" value="[[ page:parameter($context, 'collection') ]]"/>
            <input type="hidden" name="sort" value="[[ page:parameter($context, 'sort', $defaults?sort)]]"/>
        </pb-custom-form>
        <pb-custom-form class="facets" url="api/search/facets" event="pb-results-received" subscribe="search" emit="search">
        </pb-custom-form>
    </aside>
    <nav class="top-center">
        <nav aria-label="breadcrumb">
            <ul>
                <li>
                    <a class="parent-link" role="button" data-collection="[[ browse:parent-link($context) ]]"
                        data-i18n="[title]browse.up">
                        Collections
                    </a>
                </li>
                [% if page:parameter($context, 'collection') != '' %]
                <li class="current-collection">[[ page:parameter($context, 'collection') ]]</li>
                [% endif %]
            </ul>
        </nav>
        <ul>
            [% block before-document-list %][% endblock %]
            <li>
                <pb-paginate id="paginate" per-page="10" range="5" subscribe="search" emit="search"></pb-paginate>
            </li>
        </ul>
    </nav>
    <main id="document-list">
        <pb-load url="api/collection/{collection}" expand="" emit="search"></pb-load>
    </main>
    <nav class="top-right">
        <ul>
            <li>
                <a class="aside-toggle" title="Hide" data-toggle=".right">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    class="bi bi-arrow-bar-left" viewBox="0 0 16 16">
                    <path fill-rule="evenodd"
                    d="M12.5 15a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 1 0v13a.5.5 0 0 1-.5.5M10 8a.5.5 0 0 1-.5.5H3.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L3.707 7.5H9.5a.5.5 0 0 1 .5.5" />
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
    <aside class="right">
        [% block browse-aside %][% endblock %]
        [% if $context?features?upload %]
        <pb-restricted group="[[ $pkg?user?group ]]">
            [% if $context?defaults?upload %]
            <pb-upload id="upload" subscribe="search" emit="search" accept=".xml, .tei, .odd, .docx, .md, .mei" 
                event="pb-search-resubmit" target="[[ $context?defaults?upload ]]"></pb-upload>
            [% else %]
            <pb-upload id="upload" subscribe="search" emit="search" accept=".xml, .tei, .odd, .docx, .md, .mei" 
                event="pb-search-resubmit"></pb-upload>
            [% endif %]
        </pb-restricted>
        [% endif %]
    </aside>
</template>