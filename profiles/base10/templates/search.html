<template>
    ---json
    {
        "features": {
            "toolbar": {
                "navigation": false
            }
        },
        "templating": {
            "extends": "templates/layouts/content.html"
        },
        "script": {
            "custom": [
                "resources/scripts/facets.js"
            ]
        }
    }
    ---
    <style>
        main {
            padding: 1rem;
        }

        pb-search .targets {
            margin-top: 1rem;
        }

        /* Fix for overlapping targets and pb-custom-form */
        .right > pb-search {
            margin-bottom: 1rem;
            height: fit-content;
        }
    </style>
    <main>
        <pb-load id="results" url="api/search" emit="results"></pb-load>
    </main>

    [% template after %]
    <pb-search id="search-form" subscribe="search"
        value="[[ page:parameter($context, 'query', '') ]]"
        submit-on-load="submit-on-load" subforms=".facets">
        <div class="targets">
            <label>
                <input type="checkbox" name="field" value="text"/>
                Search sections
            </label>
            <label>
                <input type="checkbox" name="field" value="head"/>
                Search headings
            </label>
        </div>
        <button slot="searchButton"><pb-i18n key="search.search">Search</pb-i18n></button>
    </pb-search>
    <pb-custom-form class="facets" url="api/search/facets" subscribe="results" event="pb-results-received" emit="search"/>
    [% endtemplate %]
</template>
