<aside class="mobile menu">
    <nav>
        <ul>
            [% for $item in $menu?items?* %]
            [% if $item?url or $item?url = '' %]
            <li>
                <a href="[[ $context-path ]]/[[ $item?url ]]"><pb-i18n key="menu.[[ $item?id ]]">[[ $item?id ]]</pb-i18n></a>
            </li>
            [% elif exists($item?subitems) %]
            <li>
                <details class="dropdown">
                    <summary><pb-i18n key="menu.[[ $item?id ]]">[[ $item?id ]]</pb-i18n></summary>
                    <ul dir="rtl">
                        [% for $subitem in $item?subitems?* %]
                        <li>
                            <a href="[[ $context-path ]]/[[ $subitem?url ]]"><pb-i18n key="menu.[[ $subitem?id ]]">[[ $subitem?id ]]</pb-i18n></a>
                        </li>
                        [% endfor %]
                    </ul>
                </details>
            </li>
            [% endif %]
            [% endfor %]
            [% if $menu?language %]
            <li>
                <pb-lang name="lang">
                    [% for $lang in map:keys($languages) %]
                    <option value="[[ $lang ]]">[[ $languages?($lang) ]]</option>
                    [% endfor %]
                </pb-lang>
            </li>
            [% endif %]

            [# display download menu items if in document view #]
            [% if exists($context?doc) and $menu?download %]
                <li>
                    <pb-edit-xml src="document1" data-i18n="[title]menu.download.view-tei" title="view-tei">
                        XML
                    </pb-edit-xml>
                </li>
                [% if empty($context?media) or "print" = $context?media %]
                <li>
                    <a href="[[ $context-path ]]/print/[[ $context?doc?path ]]" target="_new">Print CSS</a>
                </li>
                [% endif %]
                [% if empty($context?media) or "latex" = $context?media %]
                <li>
                    <pb-download type="tex" src="document1" dialog="downloadDialog" data-i18n="[title]menu.download.pdf-latex" title="i18n(pdf-latex)">
                        <pb-i18n key="menu.download.pdf-latex">Download</pb-i18n>
                    </pb-download>
                </li>
                [% endif %]
                [% if empty($context?media) or "latex" = $context?media %]
                <li>
                    <pb-download type="tex" src="document1" dialog="downloadDialog" data-i18n="[title]menu.download.pdf-latex" title="i18n(pdf-latex)" source="source">
                        <pb-i18n key="menu.download.latex-source"></pb-i18n>
                    </pb-download>
                </li>
                [% endif %]
                [% if empty($context?media) or "fo" = $context?media %]
                <li>
                    <pb-download type="pdf" src="document1" dialog="downloadDialog" data-i18n="[title]menu.download.pdf-fo" title="i18n(pdf-fo)">
                        <pb-i18n key="menu.download.pdf-fo"></pb-i18n>
                    </pb-download>
                </li>
                [% endif %]
                [% if empty($context?media) or "fo" = $context?media %]
                <li>
                    <pb-download type="pdf" src="document1" dialog="downloadDialog" data-i18n="[title]menu.download.fo-source" title="pdf-fo" source="source">
                        <pb-i18n key="menu.download.fo-source"></pb-i18n>
                    </pb-download>
                </li>
                [% endif %]
                [% if empty($context?media) or "epub" = $context?media %]
                <li>
                    <pb-download type="epub" src="document1" dialog="downloadDialog">
                        ePUB
                    </pb-download>
                </li>
                [% endif %]
            [% endif %]
        </ul>
    </nav>
</aside>
